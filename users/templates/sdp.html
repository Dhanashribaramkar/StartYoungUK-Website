{% extends 'base.html' %}
{% load static %}
{% block content %}
<style>
    #paypal-container {
        position: relative;
        left: -25%;
        margin: 5% 0;
    }

    p {
        color: #060606
    }
</style>

{% if sdp_frequency == 'N' %}
<!-- if user has no SDP setup -->
<div style="padding:140px; background-image: url('{% static 'images/bg_1.jpg' %}');">

    {% if messages %}
    {% for message in messages %}
    <div class="alert alert-{{ message.tags }}">
        {{ message }}
    </div>
    {% endfor %}
    {% endif %}


    <div class="page-wrapper bg-red p-t-180 p-b-100 font-robo">
        <div class="wrapper wrapper--w960">
            <div class="card card-2">
                <div class="card-body">

                    <h2>Systematic Donation Plan (SDP)</h2>
                    <h3>Return on investment would be continued returns in the form of smile on a child's
                        face!</h3>
                    {% if button_enable %}
                    {% if is_buddy %}
                    <class="text-muted"><b>By signing up for our Systematic Donation Plan, you agree to have a recurring
                            weekly payment
                            of £5.</b></class>
                        {% else %}
                        <class="text-muted"><b>Please fill out the form below to select the frequency and amount of your
                                payments.</b>
                            </class>
                            {% endif %}
                            <class="text-muted"><b>By clicking on "Start SDP", you are agreeing to our Terms &
                                    Conditions.</b></class>
                                <div id="paypal-container" class="row justify-content-center">
                                    <div class="col-md-6">{{ paypal_btn.render }}</div>
                                </div>
                                {% else %}
                                {% load crispy_forms_tags %}
                                <form method="POST" class="post-form" id="sdp-form">
                                    {% csrf_token %}
                                    <fieldset class="form-group">
                                        {{ form|crispy }}
                                    </fieldset>
                                    {% if button_enable %}
                                    <button class="signup-btn btn btn-primary" type="submit" data-toggle="modal"
                                        data-target='#paypal-container' hidden>Start SDP</button>
                                    {% else %}
                                    <button class="signup-btn btn btn-primary" type="submit" data-toggle="modal"
                                        data-target='#paypal-container'>Start SDP</button>
                                    {% endif %}
                                </form>
                                {% endif %}
                                <br>
                                <p>If you do not wish to use PayPal, you can set up a standing order from your bank
                                    account for the amount of £5 per week (minimum)
                                    to support your child sponsor.</p>
                                <p>Once set up please email <a
                                        href="mailto:startyoung21@gmail.com">startyoung21@gmail.com</a> to
                                    confirm which
                                    month your
                                    direct debit will begin.</p>
                                <p>Sort code: 60-03-19 <br> Account number: 79913334 <br> NatWest Bank</p>
                </div>
            </div>
        </div>
    </div>

</div>
{% else %}
<!-- if user has an active SDP -->
<div style="padding:140px; background-image: url('{% static 'images/bg_1.jpg' %}');">
    <h1>Systematic Donation Plan (SDP)</h1>
    <h2>You have an active plan:</h2>
    <class="text-muted"><b>Frequency: {{ sdp_frequency }}</b></class><br>
        <class="text-muted"><b>Amount: £{{ sdp_amount }}</b></class><br>
            <p style="margin:50px 0 0 0;">In order to cancel your SDP, please use the link below to cancel your
                subscription from PayPal's side:</p><br>
            <a href="https://www.paypal.com/myaccount/autopay/">Cancel your Plan</a>
</div>
{% endif %}

{% if is_buddy %}
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    $(document).ready(function () {
        // pointer-events:none;
        // background:grey;
        var choiceField = $('#id_frequency');
        choiceField.css({
            'pointer-events': 'none',
            'background': 'grey'
        })
        // choiceField.prop('disabled', true);
    });
</script>
{% endif %}

{% endblock %}